# 정규화(Normailization)

>가장 큰 목표 목표는 `테이블 간에 중복된 데이터를 혀용하지 않는다는 것`입니다.  
중복된 데이터를 허용하지 않음으로써 `무결성(Integrity)를 유지할 수 있으며, DB의 저장 용량을 줄일 수있습니다.`

## 목적
* 데이터의 중복을 없애면서 불필요한 데이터를 최소화
* 무결성을 지키고, 이상 현상을 방지
* 테이블을 논리적이고 직관적으로 구성
* 데이터베이스 구조가 확장에 용이해짐

## 단계
1. [제 1정규화](#제-1-정규화1nf)
2. [제 2정규화](#제-2-정규화2nf)
3. [제 3정규화](#제-3-정규화3nf)
4. [BCNF 정규화](#bcnf-정규화)

## 제 1 정규화(1NF)

>`제 1 정규화`는 테이블의 컬럼이 원자값(Atomic Value, 하나의 값)을 갖도록 테이블을 분해하는 것입니다.

### 조건
* 어떤 릴레이션에 속한 `모든 도메인이 원자값`으로 되어 있어야 합니다.
* 모든 속성에 반복되는 그룹이 나타나지 않습니다.
* 기본키를 사용하여 관련 데이터의 각 집합을 고유하게 식별할 수 있어야 합니다.

### 예시

![image](https://user-images.githubusercontent.com/37105602/219086303-0e01e17a-b505-47d8-b88e-163542dc72a7.png)

***위 테이블에서 추신수와 박세리는 취미의 개수가 1개가 아니기에 제 1 정규형을 만족하지 못합니다.***  

아래와 같이 제 1 정규화하여 분해할 수 있습니다.

![image](https://user-images.githubusercontent.com/37105602/219086409-cc79c679-64c7-4cd1-9526-ac0f760b67a9.png)

## 제 2 정규화(2NF)

>`제 2 정규화`는 [1NF](#제-1-정규화1nf)를 진행한 테이블에 대해 **완전 함수 종속**을 만족하도록 테이블을 분해하는 것 입니다.
>* 완전 함수 종속 : `기본키의 부분집합이 결정자가 되어선 안된다는 것`

### 예시

![image](https://user-images.githubusercontent.com/37105602/219086539-0977404b-2f77-45d7-84c3-496266643964.png)

위 테이블에서 기본키는 (학생번호, 강좌이름)으로 복합키입니다.  
그리고 (학생번호, 강좌이름)인 기본키는 성적을 결정하고 있습니다.  
(학생번호, 강좌이름) --> (성적)

그런데 여기서 강의실이라는 컬럼은 기본키의 부분집합인 강좌이름에 의해 결정될 수 있습니다. (강좌이름) --> (강의실)

즉, 기본키(학생번호, 강좌이름)의 부분키인 (강좌이름)이 결정자이기 때문에  
위의 테이블의 경우 다음과 같이 기존의 테이블에서 강의실을 분해하여 별도의 테이블로 관리하여 제 2 정규형을 만족시킬 수 있습니다.

![image](https://user-images.githubusercontent.com/37105602/219086748-96da7060-7a1a-40f6-943a-44aaaeaf8812.png)

## 제 3 정규화(3NF)
>[2NF](#제-2-정규화2nf)가 진행된 테이블에서 `이행적 종속을 없애기 위해 테이블을 분리`하는 것입니다.  
>* 이행적 종속 : A → B, B → C면 A → C가 성립됩니다.

### 조건
* 릴레이션이 [2NF](#제-2-정규화2nf)에 만족해야합니다.
* 기본키가 아닌 속성들은 기본키에 의존합니다.

### 예시

![image](https://user-images.githubusercontent.com/37105602/219086812-ca6f6a52-1701-40cb-bbed-08f7d5a7395b.png)

기존의 테이블에서 학생 번호는 강좌이름을 결정하고 있고, 강좌이름은 수강료를 결정하고 있습니다.  
그렇기 때문에 이름 (학생번호, 강좌 이름)테이블과 (강좌 이름, 수강료)테이블로 분해해야합니다.

`이행적 종속을 제거하는 이유`  
501번 학생이 수강하는 강좌가 스포츠 경영학으로 변경되었다고 **가정**하면,  
***이행적 종속이 존재할 때 501번의 학생은 스포츠 경영학이라는 수업을 20000원이라는 수강료로 듣게 됩니다.***  
물론 강좌 이름에 맞게 수강료를 다시 변경할 수 있지만, 이러한 번거로움을 해결하기 위해 제 3 정규화를 이행합니다.


즉, 학생 번호를 통해 강좌 이름을 참조하고,  
강좌 이름으로 수강료를 참조하도록 테이블을 분해해야합니다.

![image](https://user-images.githubusercontent.com/37105602/219086881-cb1c17ec-15ae-4197-a6ff-9e079d2a95bb.png)

## BCNF 정규화
>[3NF](#제-3-정규화3nf)를 진행한 테이블에 대해 모든 `결정자가 후보키가 되도록 테이블을 분해하는 것`입니다.

### 예시

![image](https://user-images.githubusercontent.com/37105602/219086985-37544676-677e-4e5b-b5c5-4edf512cd5fd.png)

특수수강 테이블에서 기본키는 (학생번호, 특강이름)입니다.  
그리고 기본키(학생번호, 특강이름)는 교수를 결정하고 있습니다.  
또한, 여기서 교수는 특강이름을 결정하고 있습니다.

***여기서 문제는 교수가 특강이름을 결정하는 결정자이지만, 후보키가 아니라는 점입니다.***  
그렇기 때문에 BCNF 정규화를 만족시키기 위해서 위의 테이블을 다음과 같이 **특강신청 테이블**과 **특강교수 테이블**로 분해해야합니다.

![image](https://user-images.githubusercontent.com/37105602/219087097-6574356e-2a32-403b-928d-8305ce37f70a.png)

## Reference
* [키(Key) 종류 정리](./DB_Key.md)
* https://mangkyu.tistory.com/110