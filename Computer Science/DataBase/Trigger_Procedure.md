# 트리거(Trigger)와 프로시저(Procedure)

## 트리거 (Trigger) 💣

```
특정 테이블에 INSERT, UPDATE, DELETE와 같은 DML문이 수행되었을 때,
DB에서 자동으로 동작하돋록 작성된 프로그램
```

### 특징

- 테이블, 뷰, DB작업을 대상으로 정의할 수 있고, 전체 트랜잭션 작업에 대해<br>
  발생되는 Trigger와 각 행에 대해 발생하는 Trigger가 있음

- DB 보안의 적용, 유효하지 않은 트랜잭션의 예방, 업무 규칙 자동 적용 등에 사용될 수 있음

- 무결성 유지, 로그 메시지 출력 등의 목적으로 사용한다

- 효과적인 데이터 보관

### 단점

- 유지보수의 어려움 (문서화 하지 않는다면, 중간 투입된 개발자들은 파악 어려움)<br>
  과도한 사용 시 복잡한 상호 의존성을 야기

- 하나의 트리거가 활성화 –> 이 트리거 내의 SQL문 수행 –> 그 결과로 다른 트리거를 활성화 <br>–> 그 트리거의 SQL 문 수행 –> 반복 (대규모 데이터베이스에서는 관리가 어려움)

<br><br>

## 프로시저 (Procedure) ⚡️

```
저장 프로시저는 미리 데이터베이스 서버에 일련의 SQL 문을 만들어 두고
프로시저들을 수행하여 SQL 문을 간단히 실행 할 수 있게 고안한 것
```

### 특징

- SQL 문만 뿐만아니라 실행부에서 IF 문 WHILE 문 과 같은<br>
  제어문/반복문을 사용할 수 있기 때문에 절차형 프로그램이 가능 하게 된다

- 시스템의 일일 마감 작업, 일괄 작업 등에 주로 사용된다

- 스토어드(Stored) 프로시저라고도 불린다.

- 하나의 요청으로 여러 SQL문을 실행 가능 (네트워크 부하를 줄여줌)
  <br>->네트워크 소요 시간을 줄여 성능 개선 가능

- 기능 변경이 편리 (특정 기능을 변경할 때 프로시저만 변경하는 식으로)

### 단점

- 문자나 숫자열 연산에 사용 시 오히려 C, Java보다 성능 저하를 유발할 수 있음

- 유지보수가 어려움 (문서화 해두지 않으면 어디에 사용되는지 파악 어려움, 트리거와 비슷)

<br><br>

## 차이점 ✨

|       프로시저        |        트리거         |
| :-------------------: | :-------------------: |
| CREATE Procedure 문법 |  CREATE Trigger 문법  |
| EXECUTE 명령어로 실행 |   생성 후 자동 실행   |
| COMMIT, ROLLBACK 가능 | COMMIT, ROLLBACK 안됨 |

<br>

- 트리거 내부에서 프로시저 정의 가능 프로시저 내부에서 트리거 정의 불가 ❗<br>(트리거는 이벤트 발생 시 자동으로 호출되어야 하므로)

- 트리거는 매개 변수 값이나 코드를 반환할 수 없음 ❗<br>
  프로시저는 매개 변수 값이나 코드를 반환할 수 있음 (리턴값 없어도 됨, 수행하는 절차가 목적이기 때문)
